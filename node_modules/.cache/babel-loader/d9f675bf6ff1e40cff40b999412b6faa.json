{"ast":null,"code":"import _regeneratorRuntime from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/miguelmerchan/Documents/GitHub/6-Leidy2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import TronWeb from\"tronweb\";import Utils from\"../../utils\";import Home from\"../V1Home\";import TronLinkGuide from\"../TronLinkGuide\";import contractAddress from\"../Contract\";import cons from\"../../cons\";var FOUNDATION_ADDRESS=\"TWiWt5SEDzaEqS6kE5gandWMNfxR2B5xzg\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={admin:false,tronWeb:{installed:false,loggedIn:false}};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;var isAdmin;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return new Promise(function(resolve){var tronWebState={installed:!!window.tronWeb,loggedIn:window.tronWeb&&window.tronWeb.ready};if(tronWebState.installed){_this2.setState({tronWeb:tronWebState});return resolve();}var tries=0;var timer=setInterval(function(){if(tries>=10){var TRONGRID_API=\"https://api.trongrid.io\";window.tronWeb=new TronWeb(TRONGRID_API,TRONGRID_API,TRONGRID_API);_this2.setState({tronWeb:{installed:false,loggedIn:false}});clearInterval(timer);return resolve();}tronWebState.installed=!!window.tronWeb;tronWebState.loggedIn=window.tronWeb&&window.tronWeb.ready;if(!tronWebState.installed){return tries++;}_this2.setState({tronWeb:tronWebState});resolve();},1*1000);});case 2:if(!this.state.tronWeb.loggedIn){// Set default address (foundation address) used for contract calls\n// Directly overwrites the address object if TronLink disabled the\n// function call\nwindow.tronWeb.defaultAddress={hex:window.tronWeb.address.toHex(FOUNDATION_ADDRESS),base58:FOUNDATION_ADDRESS};window.tronWeb.on(\"addressChange\",function(){if(_this2.state.tronWeb.loggedIn){return;}_this2.setState({tronWeb:{installed:true,loggedIn:true}});});}Utils.setTronWeb(window.tronWeb);_context.next=6;return Utils.setContract(window.tronWeb,contractAddress);case 6:_context.next=8;return Utils.contract.admin(window.tronWeb.defaultAddress.base58).call();case 8:isAdmin=_context.sent;this.setState({admin:isAdmin});case 10:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var getString=\"\";var loc=document.location.href;//console.log(loc);\nif(loc.indexOf('?')>0){getString=loc.split('?')[1];getString=getString.split('#')[0];}if(!this.state.tronWeb.installed)return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(TronLinkGuide,null)));if(!this.state.tronWeb.loggedIn)return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(TronLinkGuide,{installed:true})));switch(getString){case\"v1\":case\"V1\":return/*#__PURE__*/React.createElement(Home,{admin:this.state.admin,contractAddress:cons.SC2,version:\"3\"});case\"v2\":case\"V2\":return/*#__PURE__*/React.createElement(Home,{admin:this.state.admin,contractAddress:cons.SC2,version:\"3\"});case\"shasta\":case\"test\":case\"v0\":case\"V0\":return/*#__PURE__*/React.createElement(Home,{admin:this.state.admin,contractAddress:cons.SCtest,version:\"999\"});default:return/*#__PURE__*/React.createElement(Home,{admin:this.state.admin,contractAddress:cons.SC2,version:\"3\"});}}}]);return App;}(Component);export default App;// {tWeb()}","map":{"version":3,"sources":["/Users/miguelmerchan/Documents/GitHub/6-Leidy2/src/components/App/index.js"],"names":["React","Component","TronWeb","Utils","Home","TronLinkGuide","contractAddress","cons","FOUNDATION_ADDRESS","App","props","state","admin","tronWeb","installed","loggedIn","Promise","resolve","tronWebState","window","ready","setState","tries","timer","setInterval","TRONGRID_API","clearInterval","defaultAddress","hex","address","toHex","base58","on","setTronWeb","setContract","contract","call","isAdmin","getString","loc","document","location","href","indexOf","split","SC2","SCtest"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport TronWeb from \"tronweb\";\n\nimport Utils from \"../../utils\";\nimport Home from \"../V1Home\";\nimport TronLinkGuide from \"../TronLinkGuide\";\nimport contractAddress from \"../Contract\";\n\nimport cons from \"../../cons\"\n\nconst FOUNDATION_ADDRESS = \"TWiWt5SEDzaEqS6kE5gandWMNfxR2B5xzg\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      admin: false,\n      tronWeb: {\n        installed: false,\n        loggedIn: false\n      }\n    };\n  }\n\n  async componentDidMount() {\n    await new Promise(resolve => {\n      const tronWebState = {\n        installed: !!window.tronWeb,\n        loggedIn: window.tronWeb && window.tronWeb.ready\n      };\n\n      if (tronWebState.installed) {\n        this.setState({\n          tronWeb: tronWebState\n        });\n\n        return resolve();\n      }\n\n      let tries = 0;\n\n      const timer = setInterval(() => {\n        if (tries >= 10) {\n\n          const TRONGRID_API = \"https://api.trongrid.io\";\n\n          window.tronWeb = new TronWeb(\n            TRONGRID_API,\n            TRONGRID_API,\n            TRONGRID_API\n          );\n\n          this.setState({\n            tronWeb: {\n              installed: false,\n              loggedIn: false\n            }\n          });\n          clearInterval(timer);\n          return resolve();\n        }\n\n        tronWebState.installed = !!window.tronWeb;\n        tronWebState.loggedIn = window.tronWeb && window.tronWeb.ready;\n\n        if (!tronWebState.installed) {\n          return tries++;\n        }\n\n        this.setState({\n          tronWeb: tronWebState\n        });\n\n        resolve();\n      }, 1*1000);\n    });\n\n    if (!this.state.tronWeb.loggedIn) {\n      // Set default address (foundation address) used for contract calls\n      // Directly overwrites the address object if TronLink disabled the\n      // function call\n      window.tronWeb.defaultAddress = {\n        hex: window.tronWeb.address.toHex(FOUNDATION_ADDRESS),\n        base58: FOUNDATION_ADDRESS\n      };\n\n      window.tronWeb.on(\"addressChange\", () => {\n        if (this.state.tronWeb.loggedIn) {\n          return;\n        }\n\n        this.setState({\n          tronWeb: {\n            installed: true,\n            loggedIn: true\n          }\n        });\n      });\n    }\n\n    Utils.setTronWeb(window.tronWeb);\n    await Utils.setContract(window.tronWeb, contractAddress);\n\n    var isAdmin = await Utils.contract.admin(window.tronWeb.defaultAddress.base58).call();\n\n    this.setState({\n      admin: isAdmin\n    });\n     \n    \n  }\n\n\n  render() {\n\n    var getString = \"\";\n    var loc = document.location.href;\n    //console.log(loc);\n    if(loc.indexOf('?')>0){\n              \n      getString = loc.split('?')[1];\n      getString = getString.split('#')[0];\n\n    }\n\n    if (!this.state.tronWeb.installed) return (\n      <>\n        <div className=\"container\">\n          <TronLinkGuide />\n        </div>\n      </>\n      );\n\n    if (!this.state.tronWeb.loggedIn) return (\n      <>\n        <div className=\"container\">\n          <TronLinkGuide installed />\n        </div>\n      </>\n      );\n\n    switch (getString) {\n      case \"v1\": \n      case \"V1\": \n        return(<Home admin={this.state.admin} contractAddress={cons.SC2} version=\"3\"/>);\n      case \"v2\":\n      case \"V2\": \n        return(<Home admin={this.state.admin} contractAddress={cons.SC2} version=\"3\"/>);\n      case \"shasta\":\n      case \"test\":\n      case \"v0\":\n      case \"V0\": \n        return(<Home admin={this.state.admin} contractAddress={cons.SCtest} version=\"999\"/>);\n      default:\n        return(<Home admin={this.state.admin} contractAddress={cons.SC2} version=\"3\"/>);\n    }\n\n\n  }\n}\nexport default App;\n\n// {tWeb()}\n"]},"metadata":{},"sourceType":"module"}